obtv-admin@stagelink:~/stagelink$ docker-compose up -d
[+] Running 4/4
 ✔ Network stagelink_virtual-audience-network  Created                                                                         0.1s
 ✔ Volume "stagelink_postgres_data"            Created                                                                         0.0s
 ✔ Container virtual-audience-db-v2            Healthy                                                                        10.9s
 ✔ Container virtual-audience-app-v2           Started                                                                        11.1s
obtv-admin@stagelink:~/stagelink$ docker-compose logs -f
virtual-audience-app-v2  | Waiting for database...
virtual-audience-db-v2   | The files belonging to this database system will be owned by user "postgres".
virtual-audience-db-v2   | This user must also own the server process.
virtual-audience-db-v2   |
virtual-audience-db-v2   | The database cluster will be initialized with locale "en_US.utf8".
virtual-audience-db-v2   | The default database encoding has accordingly been set to "UTF8".
virtual-audience-db-v2   | The default text search configuration will be set to "english".
virtual-audience-db-v2   |
virtual-audience-db-v2   | Data page checksums are disabled.
virtual-audience-db-v2   |
virtual-audience-db-v2   | fixing permissions on existing directory /var/lib/postgresql/data ... ok
virtual-audience-db-v2   | creating subdirectories ... ok
virtual-audience-db-v2   | selecting dynamic shared memory implementation ... posix
virtual-audience-db-v2   | selecting default max_connections ... 100
virtual-audience-db-v2   | selecting default shared_buffers ... 128MB
virtual-audience-db-v2   | selecting default time zone ... UTC
virtual-audience-db-v2   | creating configuration files ... ok
virtual-audience-db-v2   | running bootstrap script ... ok
virtual-audience-db-v2   | sh: locale: not found
virtual-audience-db-v2   | 2025-08-20 01:05:34.999 UTC [35] WARNING:  no usable system locales were found
virtual-audience-db-v2   | performing post-bootstrap initialization ... ok
virtual-audience-db-v2   | syncing data to disk ... ok
virtual-audience-db-v2   | initdb: warning: enabling "trust" authentication for local connections
virtual-audience-db-v2   | initdb: hint: You can change this by editing pg_hba.conf or using the option -A, or --auth-local and --auth-host, the next time you run initdb.
virtual-audience-db-v2   |
virtual-audience-db-v2   |
virtual-audience-db-v2   | Success. You can now start the database server using:
virtual-audience-db-v2   |
virtual-audience-db-v2   |     pg_ctl -D /var/lib/postgresql/data -l logfile start
virtual-audience-db-v2   |
virtual-audience-db-v2   | waiting for server to start....2025-08-20 01:05:35.658 UTC [41] LOG:  starting PostgreSQL 15.14 on x86_64-pc-linux-musl, compiled by gcc (Alpine 14.2.0) 14.2.0, 64-bit
virtual-audience-db-v2   | 2025-08-20 01:05:35.660 UTC [41] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
virtual-audience-db-v2   | 2025-08-20 01:05:35.665 UTC [44] LOG:  database system was shut down at 2025-08-20 01:05:35 UTC
virtual-audience-db-v2   | 2025-08-20 01:05:35.675 UTC [41] LOG:  database system is ready to accept connections
virtual-audience-db-v2   |  done
virtual-audience-db-v2   | server started
virtual-audience-db-v2   | CREATE DATABASE
virtual-audience-db-v2   |
virtual-audience-db-v2   |
virtual-audience-db-v2   | /usr/local/bin/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/init.sql
virtual-audience-db-v2   |  ?column?
virtual-audience-db-v2   | ----------
virtual-audience-db-v2   | (0 rows)
virtual-audience-db-v2   |
virtual-audience-db-v2   | You are now connected to database "virtual_audience" as user "postgres".
virtual-audience-db-v2   | DROP SCHEMA
virtual-audience-db-v2   | CREATE SCHEMA
virtual-audience-db-v2   | GRANT
virtual-audience-db-v2   | GRANT
virtual-audience-db-v2   | GRANT
virtual-audience-db-v2   | GRANT
virtual-audience-db-v2   | ALTER DEFAULT PRIVILEGES
virtual-audience-db-v2   | ALTER DEFAULT PRIVILEGES
virtual-audience-db-v2   | CREATE TABLE
virtual-audience-db-v2   | CREATE TABLE
virtual-audience-db-v2   | CREATE TABLE
virtual-audience-db-v2   | CREATE TABLE
virtual-audience-db-v2   | CREATE TABLE
virtual-audience-db-v2   | CREATE TABLE
virtual-audience-db-v2   | CREATE TABLE
virtual-audience-db-v2   | CREATE INDEX
virtual-audience-db-v2   | CREATE INDEX
virtual-audience-db-v2   | CREATE INDEX
virtual-audience-db-v2   | CREATE INDEX
virtual-audience-db-v2   | INSERT 0 1
virtual-audience-db-v2   | Virtual Audience Platform v2.0 database schema initialized successfully with session token support;
virtual-audience-db-v2   |
virtual-audience-db-v2   |
virtual-audience-db-v2   | waiting for server to shut down....2025-08-20 01:05:35.946 UTC [41] LOG:  received fast shutdown request
virtual-audience-db-v2   | 2025-08-20 01:05:35.948 UTC [41] LOG:  aborting any active transactions
virtual-audience-db-v2   | 2025-08-20 01:05:35.954 UTC [41] LOG:  background worker "logical replication launcher" (PID 47) exited with exit code 1
virtual-audience-db-v2   | 2025-08-20 01:05:35.955 UTC [42] LOG:  shutting down
virtual-audience-db-v2   | 2025-08-20 01:05:35.956 UTC [42] LOG:  checkpoint starting: shutdown immediate
virtual-audience-db-v2   | 2025-08-20 01:05:35.998 UTC [42] LOG:  checkpoint complete: wrote 946 buffers (5.8%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.023 s, sync=0.017 s, total=0.044 s; sync files=335, longest=0.001 s, average=0.001 s; distance=4394 kB, estimate=4394 kB
virtual-audience-db-v2   | 2025-08-20 01:05:36.009 UTC [41] LOG:  database system is shut down
virtual-audience-db-v2   |  done
virtual-audience-db-v2   | server stopped
virtual-audience-db-v2   |
virtual-audience-db-v2   | PostgreSQL init process complete; ready for start up.
virtual-audience-db-v2   |
virtual-audience-db-v2   | 2025-08-20 01:05:36.082 UTC [1] LOG:  starting PostgreSQL 15.14 on x86_64-pc-linux-musl, compiled by gcc (Alpine 14.2.0) 14.2.0, 64-bit
virtual-audience-db-v2   | 2025-08-20 01:05:36.082 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
virtual-audience-db-v2   | 2025-08-20 01:05:36.082 UTC [1] LOG:  listening on IPv6 address "::", port 5432
virtual-audience-db-v2   | 2025-08-20 01:05:36.085 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
virtual-audience-db-v2   | 2025-08-20 01:05:36.091 UTC [60] LOG:  database system was shut down at 2025-08-20 01:05:35 UTC
virtual-audience-db-v2   | 2025-08-20 01:05:36.102 UTC [1] LOG:  database system is ready to accept connections
virtual-audience-app-v2  | Setting up Virtual Audience Platform with authentication and URL shortening...
virtual-audience-app-v2  | Existing data detected (1 users) - preserving data and updating schema...
virtual-audience-app-v2  | Session tokens table exists - checking for any missing tables and columns...
virtual-audience-app-v2  | NOTICE:  relation "viewer_links" already exists, skipping
virtual-audience-app-v2  | CREATE TABLE
virtual-audience-app-v2  | CREATE TABLE
virtual-audience-app-v2  | DROP TABLE
virtual-audience-app-v2  | CREATE TABLE
virtual-audience-app-v2  | NOTICE:  Added updated_at column to users table
virtual-audience-app-v2  | DO
virtual-audience-app-v2  | DO
virtual-audience-app-v2  | DO
virtual-audience-app-v2  | DO
virtual-audience-app-v2  | Column checks completed
virtual-audience-app-v2  | No config path provided, using default 'drizzle.config.ts'
virtual-audience-app-v2  | Reading config file '/app/drizzle.config.ts'
virtual-audience-app-v2  | Using 'pg' driver for database querying
virtual-audience-app-v2  | [⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[✓] Pulling schema from database...
virtual-audience-app-v2  |
virtual-audience-app-v2  | Is generated_links table created or renamed from another table?
virtual-audience-app-v2  | ❯ + generated_links                          create table
virtual-audience-app-v2  |   ~ sessions › generated_links               rename table
virtual-audience-app-v2  |   ~ links › generated_links                  rename table
virtual-audience-app-v2  |   ~ generated_viewer_links › generated_links rename tablenpm notice
virtual-audience-app-v2  | npm notice New major version of npm available! 10.8.2 -> 11.5.2
virtual-audience-app-v2  | npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.5.2
virtual-audience-app-v2  | npm notice To update run: npm install -g npm@11.5.2
virtual-audience-app-v2  | npm notice
virtual-audience-app-v2  | Starting Virtual Audience Platform...
virtual-audience-app-v2  | Using PostgreSQL driver for database connection
virtual-audience-app-v2  | Default admin user already exists
virtual-audience-app-v2  | 1:06:07 AM [express] serving on port 5000
virtual-audience-db-v2   | 2025-08-20 01:06:09.325 UTC [91] ERROR:  relation "IDX_session_expire" already exists
virtual-audience-db-v2   | 2025-08-20 01:06:09.325 UTC [91] STATEMENT:  CREATE TABLE "session" (
virtual-audience-db-v2   |        "sid" varchar NOT NULL COLLATE "default",
virtual-audience-db-v2   |        "sess" json NOT NULL,
virtual-audience-db-v2   |        "expire" timestamp(6) NOT NULL
virtual-audience-db-v2   |      )
virtual-audience-db-v2   |      WITH (OIDS=FALSE);
virtual-audience-db-v2   |
virtual-audience-db-v2   |      ALTER TABLE "session" ADD CONSTRAINT "session_pkey" PRIMARY KEY ("sid") NOT DEFERRABLE INITIALLY IMMEDIATE;
virtual-audience-db-v2   |
virtual-audience-db-v2   |      CREATE INDEX "IDX_session_expire" ON "session" ("expire");
virtual-audience-db-v2   |
virtual-audience-app-v2  | error: relation "IDX_session_expire" already exists
virtual-audience-app-v2  |     at /app/node_modules/pg-pool/index.js:45:11
virtual-audience-app-v2  |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
virtual-audience-app-v2  |     at async PGStore._asyncQuery (/app/node_modules/connect-pg-simple/index.js:322:21)
virtual-audience-app-v2  |     at async PGStore._rawEnsureSessionStoreTable (/app/node_modules/connect-pg-simple/index.js:186:9)
virtual-audience-app-v2  |     at async PGStore._asyncQuery (/app/node_modules/connect-pg-simple/index.js:315:7)
virtual-audience-app-v2  | error: relation "IDX_session_expire" already exists
virtual-audience-app-v2  |     at /app/node_modules/pg-pool/index.js:45:11
virtual-audience-app-v2  |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
virtual-audience-app-v2  |     at async PGStore._asyncQuery (/app/node_modules/connect-pg-simple/index.js:322:21)
virtual-audience-app-v2  |     at async PGStore._rawEnsureSessionStoreTable (/app/node_modules/connect-pg-simple/index.js:186:9)
virtual-audience-app-v2  |     at async PGStore._asyncQuery (/app/node_modules/connect-pg-simple/index.js:315:7)
virtual-audience-app-v2  | error: relation "IDX_session_expire" already exists
virtual-audience-app-v2  |     at /app/node_modules/pg-pool/index.js:45:11
virtual-audience-app-v2  |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
virtual-audience-app-v2  |     at async PGStore._asyncQuery (/app/node_modules/connect-pg-simple/index.js:322:21)
virtual-audience-app-v2  |     at async PGStore._rawEnsureSessionStoreTable (/app/node_modules/connect-pg-simple/index.js:186:9)
virtual-audience-app-v2  |     at async PGStore._asyncQuery (/app/node_modules/connect-pg-simple/index.js:315:7)
virtual-audience-app-v2  | error: relation "IDX_session_expire" already exists
virtual-audience-app-v2  |     at /app/node_modules/pg-pool/index.js:45:11
virtual-audience-app-v2  |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
virtual-audience-app-v2  |     at async PGStore._asyncQuery (/app/node_modules/connect-pg-simple/index.js:322:21)
virtual-audience-app-v2  |     at async PGStore._rawEnsureSessionStoreTable (/app/node_modules/connect-pg-simple/index.js:186:9)
virtual-audience-app-v2  |     at async PGStore._asyncQuery (/app/node_modules/connect-pg-simple/index.js:315:7)
virtual-audience-app-v2  | error: relation "IDX_session_expire" already exists
virtual-audience-app-v2  |     at /app/node_modules/pg-pool/index.js:45:11
virtual-audience-app-v2  |     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
virtual-audience-app-v2  |     at async PGStore._asyncQuery (/app/node_modules/connect-pg-simple/index.js:322:21)
virtual-audience-app-v2  |     at async PGStore._rawEnsureSessionStoreTable (/app/node_modules/connect-pg-simple/index.js:186:9)
virtual-audience-app-v2  |     at async PGStore._asyncQuery (/app/node_modules/connect-pg-simple/index.js:315:7)
